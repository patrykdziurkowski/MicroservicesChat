<div th:fragment="userSettingsModal" class="modal fade" id="userSettings" tabindex="-1"
    aria-labelledby="userSettingsLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="userSettingsLabel">User settings</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="text" class="form-control" id="usernameInput" placeholder="Username">
                </div>
                <button class="btn btn-primary" value="Save" id="saveUsernameButton"
                    onclick="saveUsername()">Save</button>
            </div>
        </div>
    </div>

    <script>
        function saveUsername() {
            const username = document.querySelector("#usernameInput").value;
            const payload = {
                userName: username
            }
            const request = fetch('/username', {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const result = request.then(response => {
                if (response.status !== 200) {
                    console.error('Unable to change username.');
                    return;
                }

                document.querySelector('#userNameLabel').innerText = username;
            }).catch(error => console.error(error));
        }
    </script>
</div>